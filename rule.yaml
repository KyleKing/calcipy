---
# Experimenting with writing semgrep rules
#
# Test online with:
# https://semgrep.dev/playground/new?editorMode=advanced
#
# Run locally with:
# poetry run semgrep --config rule.yaml .

rules:
  - id: repeated_get_dg
    patterns:
      - pattern-regex: get_dg\(\)([^\n]+(\n\n? {4,})[^\n]*get_dg\(\))+
    message: 'Multiple get_dg calls made. Use a local variable instead: "dg = get_dg()"'
    languages:
      - python
    severity: ERROR
